!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/platform-browser"),require("rxjs/operators"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-doc-viewer",["exports","@angular/core","@angular/platform-browser","rxjs/operators","rxjs","@angular/common"],r):r((e=e||self)["ngx-doc-viewer"]={},e.ng.core,e.ng.platformBrowser,e.rxjs.operators,e.rxjs,e.ng.common)}(this,(function(e,r,n,t,o,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function l(e,r,n,t){var o,i=arguments.length,l=i<3?r:null===t?t=Object.getOwnPropertyDescriptor(r,n):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,r,n,t);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(l=(i<3?o(l):i>3?o(r,n,l):o(r,n))||l);return i>3&&l&&Object.defineProperty(r,n,l),l}function a(e,r,n,t){return new(n||(n=Promise))((function(o,i){function l(e){try{s(t.next(e))}catch(e){i(e)}}function a(e){try{s(t.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):new n((function(r){r(e.value)})).then(l,a)}s((t=t.apply(e,r||[])).next())}))}function s(e,r){var n,t,o,i,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,t&&(o=2&i[0]?t.return:i[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,i[1])).done)return o;switch(t=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,t=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(o=(o=l.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=r.call(e,l)}catch(e){i=[6,e],t=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}var u=function(){function e(e,n){this.domSanitizer=e,this.ngZone=n,this.fullUrl=null,this.externalViewer=!1,this.docHtml="",this.configuredViewer="google",this.checkIFrameSubscription=null,this.loaded=new r.EventEmitter,this.url="",this.queryParams="",this.googleCheckInterval=3e3,this.disableContent="none",this.googleCheckContentLoaded=!0}return e.prototype.ngOnDestroy=function(){this.checkIFrameSubscription&&this.checkIFrameSubscription.unsubscribe()},e.prototype.ngOnChanges=function(e){return a(this,void 0,void 0,(function(){var r,n,i,l,a=this;return s(this,(function(s){switch(s.label){case 0:return e&&e.viewer&&(e.viewer.isFirstChange||e.viewer.currentValue!==e.viewer.previousValue)&&("google"!==this.viewer&&"office"!==this.viewer&&"mammoth"!==this.viewer&&"pdf"!==this.viewer&&console.error("Unsupported viewer: '"+this.viewer+"'. Supported viewers: google, office, mammoth and pdf"),"mammoth"===this.viewer&&null===mammoth&&console.error("please install mammoth when using local viewer"),this.configuredViewer=this.viewer),"none"!==this.disableContent&&this.viewer,e.url&&e.url.currentValue!==e.url.previousValue||e.viewer&&e.viewer.currentValue!==e.viewer.previousValue?(this.docHtml="",this.externalViewer="google"===this.configuredViewer||"office"===this.configuredViewer,this.checkIFrameSubscription&&this.checkIFrameSubscription.unsubscribe(),this.url?[3,1]:(this.fullUrl=null,[3,4])):[3,4];case 1:return"office"!==this.configuredViewer&&"google"!==this.configuredViewer&&"pdf"!==this.configuredViewer?[3,2]:(r=this.url.indexOf("/")?encodeURIComponent(this.url):this.url,n="google"===this.configuredViewer?"https://docs.google.com/gview?url="+r+"&embedded=true":"office"===this.configuredViewer?"https://view.officeapps.live.com/op/embed.aspx?src="+r:this.url,this.queryParams&&(i=this.queryParams.startsWith("&")?"":"&",n=""+n+i+this.queryParams),this.fullUrl=this.domSanitizer.bypassSecurityTrustResourceUrl(n),"google"===this.configuredViewer&&this.googleCheckContentLoaded&&this.ngZone.runOutsideAngular((function(){var e=document.querySelector("iframe");a.checkIFrame(e),a.checkIFrameSubscription=o.interval(a.googleCheckInterval).pipe(t.take(Math.round(0===a.googleCheckInterval?0:2e4/a.googleCheckInterval))).subscribe((function(){null==e&&(e=document.querySelector("iframe"),a.checkIFrame(e)),a.reloadIFrame(e)}))})),[3,4]);case 2:return"mammoth"!==this.configuredViewer?[3,4]:(mammoth||console.error("Please install mammoth and make sure mammoth.browser.min.js is loaded."),l=this,[4,this.getDocxToHtml(this.url)]);case 3:l.docHtml=s.sent(),s.label=4;case 4:return[2]}}))}))},e.prototype.checkIFrame=function(e){var r=this;e&&(e.onload=function(){r.loaded.emit(null),r.checkIFrameSubscription&&r.checkIFrameSubscription.unsubscribe()})},e.prototype.reloadIFrame=function(e){e&&(console.log("reloading.."),e.src=e.src)},e.prototype.getDocxToHtml=function(e){return a(this,void 0,void 0,(function(){var r;return s(this,(function(n){switch(n.label){case 0:return[4,this.fileToArray(e)];case 1:return r=n.sent(),[4,mammoth.convertToHtml({arrayBuffer:r})];case 2:return[2,n.sent().value]}}))}))},e.prototype.fileToArray=function(e){return new Promise((function(r,n){try{var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(){var e=new FileReader;e.readAsArrayBuffer(t.response),e.onloadend=function(n){r(e.result)}},t.send()}catch(r){n("error while retrieving file "+e+".")}}))},e.ctorParameters=function(){return[{type:n.DomSanitizer},{type:r.NgZone}]},l([r.Output()],e.prototype,"loaded",void 0),l([r.Input()],e.prototype,"url",void 0),l([r.Input()],e.prototype,"queryParams",void 0),l([r.Input()],e.prototype,"googleCheckInterval",void 0),l([r.Input()],e.prototype,"disableContent",void 0),l([r.Input()],e.prototype,"googleCheckContentLoaded",void 0),l([r.Input()],e.prototype,"viewer",void 0),e=l([r.Component({selector:"ngx-doc-viewer",template:'<ng-container *ngIf="!externalViewer">\r\n    <div\r\n        *ngIf="configuredViewer !== \'pdf\'"\r\n        [innerHtml]="docHtml"\r\n    ></div>\r\n    <embed\r\n        *ngIf="configuredViewer === \'pdf\'"\r\n        type="application/pdf"\r\n        [src]="fullUrl"\r\n        style="width: 100%; height: 100%;"\r\n    />\r\n</ng-container>\r\n<ng-container *ngIf="externalViewer">\r\n    <iframe\r\n        *ngIf="fullUrl && disableContent === \'none\'"\r\n        id="iframe"\r\n        frameBorder="0"\r\n        [src]="fullUrl"\r\n    ></iframe>\r\n    <div\r\n        class="container"\r\n        *ngIf="disableContent !== \'none\'"\r\n    >\r\n        <div\r\n            [class.overlay-full]="disableContent === \'all\'"\r\n            [class.overlay-popout-google]="configuredViewer ===\'google\' && (disableContent === \'popout\' || disableContent === \'popout-hide\')"\r\n            [class.overlay-popout-office]="configuredViewer ===\'office\' && (disableContent === \'popout\' || disableContent === \'popout-hide\')"\r\n            [style.background-color]="disableContent === \'popout-hide\' ? \'#fff\': \'transparent\'"\r\n        >\r\n        </div>\r\n        <iframe\r\n            *ngIf="fullUrl"\r\n            id="iframe"\r\n            frameBorder="0"\r\n            [src]="fullUrl"\r\n        ></iframe>\r\n    </div>\r\n</ng-container>',styles:[":host {\n        display: block;\n    }\n    .container {\n        width: 100%;\n        height: 100%;\n        position: relative;\n    }\n    .overlay-popout-google {\n        width: 40px;\n        height: 40px;\n        right: 26px;\n        top: 11.5px;\n        position: absolute;\n        z-index: 1000;\n    }\n    .overlay-popout-office {\n        width: 100px;\n        height: 20px;\n        right: 0;\n        bottom: 0;\n        position: absolute;\n        z-index: 1000;\n    }\n    .overlay-full {\n        width: 100%;\n        height: 100%;\n        right: 0;\n        top: 0;\n        position: absolute;\n        z-index: 1000;\n    }\n    iframe {\n        width: 100%;\n        height: 100%;\n    }\n    "]})],e)}(),c=function(){function e(){}return e=l([r.NgModule({imports:[i.CommonModule],declarations:[u],exports:[u]})],e)}();e.NgxDocViewerComponent=u,e.NgxDocViewerModule=c,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-doc-viewer.umd.min.js.map